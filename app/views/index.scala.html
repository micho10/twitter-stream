@(message: String) (implicit request: RequestHeader)

@main(message) {
    <!-- The container in which the tweets will be displayed-->
    <div id="tweets"></div>
    <script type="text/javascript">
        var url = "@routes.Application.tweets().webSocketURL()";
        // Initializes the WebSocket connection using a URL generated by Play
        var tweetSocket = new WebSocket(url);

        // The handler called when a message is received
        tweetSocket.onmessage = function (event) {
            console.log(event);
            var data = JSON.parse(event.data);
            var tweet = document.createElement("p");
            var text = document.createTextNode(data.text);
            tweet.appendChild(text);
            document.getElementById("tweets").appendChild(tweet);
        };

        // The handler called when the connection is opened
        tweetSocket.onopen = function() {
            // sends a subscription request to the server
            tweetSocket.send("subscribe");
        };
    </script>

    @play20.welcome(message)

}
